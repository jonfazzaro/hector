function trend(n){function u(){var t=n.map(i),u=t.filter(function(n){return n[1]!=null});return sI=r(u),sI.slope}function f(){var t=n.map(i),u=t.filter(function(n){return n[1]!=null});return(sI=r(u),!sI)?[]:t.map(function(n,i){return sI.slope*t[i][0]+sI.intercept})}function i(n,t){return[t,n]}function r(n){var t={},i=n.length,r=0,u=0,h=0,c=0,s=0,f,e,o;if(i<2)return t;for(f=0;f<i;f++)e=n[f][0],o=n[f][1],r+=e,u+=o,h+=e*e,c+=o*o,s+=e*o;return t.slope=(i*s-r*u)/(i*h-r*r),t.intercept=(u-t.slope*r)/i,t.rSquared=Math.abs(t.slope*(s-r*u/i)/(c-u*u/i)),t}var t={};return t.line=f,t.velocity=u,t}function burnup(n,t,i,r){function s(n){Chart.Line(n,{data:p(e(t,i,r)),options:{showLines:!0,bezierCurve:!1}})}function h(){var u=e(t,i,r).map(f);return n(u).velocity()}function e(n,t,i){var r=y(n);return k(t,i).map(function(t){return{date:t,total:c(n,t,r),done:l(n,t,r)}})}function c(n,t,i){return i<t?null:n.filter(v(t)).length}function l(n,t,i){return i<t?null:n.filter(a(t)).length}function a(n){return function(t){return t.closed&&t.closed<=n}}function v(n){return function(t){return t.created<=n}}function y(n){return Math.max.apply(null,n.filter(function(n){return n.closed!=null}).map(function(n){return n.closed}))}function p(t){var i=Math.max.apply(null,t.filter(b).map(o));return{labels:t.map(w),datasets:[{label:"Stories",backgroundColor:"Blue",fill:!1,pointRadius:0,borderColor:"Blue",data:t.map(o)},{label:"Scope",backgroundColor:"#def",fill:!1,pointRadius:0,borderColor:"#def",data:t.map(function(){return i})},{label:"Done",backgroundColor:"Green",fill:!1,pointRadius:0,borderColor:"Green",data:t.map(f)},{label:"Velocity",backgroundColor:"#ada",fill:!1,pointRadius:0,borderColor:"#ada",data:n(t.map(f)).line()}]}}function w(n){return moment(n.date).format("M/D/YYYY")}function o(n){return n.total}function f(n){return n.done}function b(n){return n.total!=null}function k(n,t){for(var r=[],i=0;moment(n).add(i,"days").isSameOrBefore(t);i+=14)r.push(moment(n).add(i,"days").toDate());return r}var u={};return u.render=s,u.velocity=h,u}